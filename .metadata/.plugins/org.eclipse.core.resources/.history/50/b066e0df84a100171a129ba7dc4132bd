/*
 * Temetria.c
 *
 *  Created on: 01/07/2017
 *      Author: Jefferson
 */
#include <string.h>

#include "application.h"
#include "Accelerometer.h"
#include "clock.h"
#include "Telemetria.h"

Telemetria	telemetria;

void updateDataGPS(void) {

	if (xQueueReceive(xQueueGPS, &telemetria.GPS, (TickType_t ) 1)) {

		if(telemetria.GPS.FixQuality>0){
			adjusteClock();
		}
	}
}
//-------------------------------------------------------------------------

void updateDataAcce(void) {

	if (xQueueReceive(xQueueAcc, &telemetria.Accelerometer, (TickType_t ) 1)) {

	}
}
//-------------------------------------------------------------------------

void updateDataLevel(void) {

	if (xQueueReceive(xQueueTank, &telemetria.Tank, (TickType_t ) 1)) {

	}
}
//-------------------------------------------------------------------------

/**
 *
 * Atualiza as informções de telemetria que estão na lista de menssagens
 *
 */
void updateTLM(Telemetria* tlm,uint32_t ulNotifiedValue){

	if(ulNotifiedValue & BIT_UPDATE_GPS){

		updateDataGPS(tlm);
	}

	if(ulNotifiedValue & BIT_UPDATE_ACCE){

		updateDataAcce(tlm);
	}

	if(ulNotifiedValue & BIT_UPDATE_AD){

		updateDataLevel(tlm);
	}
}
//-------------------------------------------------------------------------
