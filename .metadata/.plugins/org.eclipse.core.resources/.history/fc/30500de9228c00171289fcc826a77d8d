#include "XF1.h"
#include <stdio.h>
#include <string.h>
#include "clock.h"
#include "Serialization.h"

#define LEN_TIME_STAMP	20

void tlm2String(DataTLM* info,ArrayPayLoad* ans){

	char timestamp[ LEN_TIME_STAMP];

	if(info!=NULL && ans!= NULL){

		clearArrayPayLoad(ans);

		getTimeStamp(timestamp,info->GPS.Date,info->GPS.Time);

		XF1_xsprintf(ans->Data,"%.8f:%.8f:%d:%d:%d:%.3f:%.3f:%.2f:%d:%d:%d:%s:%s",
				info->GPS.Lat,
				info->GPS.Lng,
				info->Accelerometer.x,
				info->Accelerometer.y,
				info->Accelerometer.z,
				info->Accelerometer.x_g,
				info->Accelerometer.y_g,
				info->Accelerometer.z_g,
				info->GPS.Speed,
				info->Tank.Level,
				info->Tank.Lock,
				info->GPS.Time,
				info->GPS.Date);

		ans->Length = strlen(ans->Data);
	}
}
//------------------------------------------------------------------------

void getTimeStamp(char* timestamp,char* date,char* time){

unix_time_in_seconds(uint8_t sec, uint8_t min, uint8_t hrs,
		uint8_t day, uint8_t mon, uint16_t year)

	memset(timestamp,0, LEN_TIME_STAMP);
	strncpy(timestamp,"20",2);
	strncat(timestamp,date+4,2);
	strncat(timestamp,date+2,2);
	strncat(timestamp,date,2);
	strcat(timestamp, time);
}
//------------------------------------------------------------------------

